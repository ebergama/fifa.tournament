<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title" style="font-size: 30px">{{theTournament.name}} - {{theTournament.creationDate | date:'dd-MM-yyyy'}}</h3>
    </div>
    <div class="panel-body">
        <span style="display: inline-block;" ng-show="players.length > 0">Tags: </span>
        <div style="display: inline-block;" ng-repeat="player in players">
            <a  ng-click="removePlayerTag(player)" class="filterLabel label label-primary" href="#" role="button" > {{player}} X </a>
        </div>
        <h3>{{thePhase}}</h3>
        <h4>Partidos</h4>
        <table class="center-block table table-striped table-hover middleData">
            <thead>
            <tr>
                <th>Dia</th>
                <th>Jugador</th>
                <th>Pareja</th>
                <th>Equipo</th>
                <th>L</th>
                <th></th>
                <th>V</th>
                <th>Equipo</th>
                <th>Jugador</th>
                <th>Pareja</th>
                <!--th>Tags</th-->
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="match in filteredMatches = (matches | matchFilter:players | tagFilter: tagFilters) | orderBy:'date'" ng-class="match.clazz">
                <td> <!--Dia-->
                    {{match.date | date:'dd-MM-yyyy'}}
                </td>

                <td ng-class="match.home.clazz"> <!--Jugador-->
                    <img class="img-circle" ng-src="{{getPicture(match.home.player)}}" ng-click="addPlayerTag(match.home.player)">
                    <span>{{match.home.player}}</span>
                </td>
                <td ng-class="match.home.clazz"> <!--Pareja-->
                        <img class="img-circle" ng-src="{{getPicture(match.home.partner)}}" ng-click="addPlayerTag(match.home.partner)">
                        <span>{{match.home.partner}}</span>
                </td>
                <td ng-class="match.home.clazz"> <!--Equipo-->
                    <div class="team {{match.home.team}}"></div>
                </td>
                <td ng-class="match.home.clazz" class="matchGoals"> <!--Local-->
                    {{match.home.goals}}
                    <span ng-if="match.home.penalties">({{match.home.penalties}})</span>
                </td>
                <td class="matchGoals">vs</td> <!--vs-->
                <td ng-class="match.away.clazz" class="matchGoals"> <!--Visitante-->
                    {{match.away.goals}}
                    <span ng-if="match.away.penalties">({{match.away.penalties}})</span>
                </td>
                <td ng-class="match.away.clazz"> <!--Equipo-->
                    <div class="team {{match.away.team}}"></div>
                </td>
                <td ng-class="match.away.clazz"> <!--Jugador-->
                    <img class="img-circle" ng-src="{{getPicture(match.away.player)}}" ng-click="addPlayerTag(match.away.player)">
                    <span>{{match.away.player}}</span>
                </td>
                <td ng-class="match.away.clazz">    <!--Pareja-->
                    <img class="img-circle" ng-src="{{getPicture(match.away.partner)}}" ng-click="addPlayerTag(match.away.partner)"  >
                    <span>{{match.away.partner}}</span>
                </td>
                <% if (user.admin) { %>
                <td ng-controller="modalController" style="border-top: 0px; background-color: #ffffff!important;"><button type="button" class="btn btn-circle btn-success" ng-click="open(match)"><i class="fa fa-fw fa-edit"></i></button></td>
                <% } %>
            </tr>

            <tr ng-hide="filteredMatches.length"><td colspan="8">Nada por aqui!</td></tr>
            </tbody>
        </table>

        <h4 ng-show="hasStandings(theTournament, thePhase)">Posiciones</h4>
        <table class="center-block table table-hover table-striped text-center middleData" ng-show="hasStandings(theTournament, thePhase)">
            <thead>
            <tr>
                <th class="text-center">#</th>
                <th class="text-center">Equipo</th>
                <th class="text-center" >Pts</th>
                <th class="text-center">PJ</th>
                <th class="text-center">PG</th>
                <th class="text-center">PE</th>
                <th class="text-center">PP</th>
                <th class="text-center">GF</th>
                <th class="text-center">GC</th>
                <th class="text-center">DG</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="position in positions">
                <td>{{$index + 1}}</td>
                <td>
                    <div ng-if="position.team" class="team {{position.team}}"></div>
                    <img class="img-circle" ng-src="{{getPicture(position.player)}}">
                    <span class="playerPosition">{{position.player}}</span>
                    <img ng-if="position.partner" class="img-circle" ng-src="{{getPicture(position.partner)}}">
                    <span class="playerPosition" ng-if="position.partner">{{position.partner}}</span>
                </td>
                <td class="table-bordered" style="background-color: aliceblue" >{{position.points}}</td>
                <td>{{position.matchesPlayed}}</td>
                <td>{{position.matchesWon}}</td>
                <td>{{position.matchesTied}}</td>
                <td>{{position.matchesLost}}</td>
                <td>{{position.goalsScored}}</td>
                <td>{{position.goalsReceived}}</td>
                <td>{{position.goalsDiff}}</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>


<div ng-controller="modalController">
    <script type="text/ng-template" id="resultsEditor">
        <div class="modal-header">
            <h3>Editar</h3>
            <h4 class="modal-title">{{match.tournament.name}} - {{match.phase}} - {{match.date | date:'dd-MM-yyyy'}}</h4>
        </div>
        <div class="modal-body">
            <table class="table table-striped table-hover middleData text-center">
                <thead>
                <tr>
                    <th class=""> <!--Equipo-->
                        <div class="team {{match.home.team}}"></div>
                    </th>
                    <th class="col-md-1" >
                        <p class="input-group">
                            <input type="date" class="form-control" datepicker-popup="{{format}}"  ng-model="match.date" is-open="opened" ng-required="true"  />
                        </p>

                    </th>
                    <th class=""> <!--Equipo-->
                        <div class="team {{match.away.team}}"></div>
                    </th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td> <!--Jugador-->
                        <span>{{match.home.player}}</span>
                    </td>
                    <th>Jugadores</th>
                    <td> <!--Jugador-->
                        <span>{{match.away.player}}</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" ng-model="match.home.partner">
                    </td>
                    <th>Compa√±eros</th>
                    <td>
                        <input type="text" ng-model="match.away.partner">
                    </td>
                </tr>
                <tr>
                    <td><input type="number" ng-model="match.home.goals"></td>
                    <th>Goles</th>
                    <td><input type="number" ng-model="match.away.goals"></td>
                </tr>
                <tr>
                    <td><input type="number" ng-model="match.home.yellowCards"></td>
                    <th>Amarillas</th>
                    <td><input type="number" ng-model="match.away.yellowCards"></td>
                </tr>
                <tr>
                    <td><input type="number" ng-model="match.home.redCards"></td>
                    <th>Rojas</th>
                    <td><input type="number" ng-model="match.away.redCards"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">OK</button>
            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
        </div>
    </script>
</div>
